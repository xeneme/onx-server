(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff3ee716"],{"00fd":function(t,e,a){var o=a("9e69"),s=Object.prototype,n=s.hasOwnProperty,i=s.toString,r=o?o.toStringTag:void 0;function l(t){var e=n.call(t,r),a=t[r];try{t[r]=void 0;var o=!0}catch(l){}var s=i.call(t);return o&&(e?t[r]=a:delete t[r]),s}t.exports=l},1310:function(t,e){function a(t){return null!=t&&"object"==typeof t}t.exports=a},"19ee":function(t,e,a){"use strict";var o=a("280d"),s=a.n(o);s.a},"1a8c":function(t,e){function a(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=a},"243c":function(t,e,a){"use strict";var o=a("a841"),s=a.n(o);s.a},"280d":function(t,e,a){},"29f3":function(t,e){var a=Object.prototype,o=a.toString;function s(t){return o.call(t)}t.exports=s},"2b3e":function(t,e,a){var o=a("585a"),s="object"==typeof self&&self&&self.Object===Object&&self,n=o||s||Function("return this")();t.exports=n},"30f7":function(t,e,a){},3219:function(t,e,a){"use strict";var o=a("92c8"),s=a.n(o);s.a},3729:function(t,e,a){var o=a("9e69"),s=a("00fd"),n=a("29f3"),i="[object Null]",r="[object Undefined]",l=o?o.toStringTag:void 0;function u(t){return null==t?void 0===t?r:i:l&&l in Object(t)?s(t):n(t)}t.exports=u},"3b36":function(t,e,a){"use strict";var o=a("db6b"),s=a.n(o);s.a},"3e44":function(t,e,a){"use strict";var o=a("30f7"),s=a.n(o);s.a},"408c":function(t,e,a){var o=a("2b3e"),s=function(){return o.Date.now()};t.exports=s},"51cc9":function(t,e,a){},"55e0":function(t,e,a){"use strict";var o=a("e709"),s=a.n(o);s.a},"585a":function(t,e,a){(function(e){var a="object"==typeof e&&e&&e.Object===Object&&e;t.exports=a}).call(this,a("c8ba"))},"7b09":function(t,e,a){},"8ef1":function(t,e,a){},"92c8":function(t,e,a){},"942f":function(t,e,a){"use strict";var o=a("bee1"),s=a.n(o);s.a},"9e69":function(t,e,a){var o=a("2b3e"),s=o.Symbol;t.exports=s},a4b0:function(t,e,a){"use strict";var o=a("51cc9"),s=a.n(o);s.a},a69d:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard"},[a("div",{staticClass:"row row-equal"},[a("div",{staticClass:"flex sm12 md5 lg4"},[a("dashboard-profile")],1),a("div",{staticClass:"flex sm12 md7 lg8"},[a("dashboard-users")],1)]),a("div",{staticClass:"row row-equal"},[a("div",{staticClass:"flex sm12 md5 lg5"},[a("dashboard-support")],1),a("div",{staticClass:"flex sm12 md7 lg7"},[a("dashboard-total-log")],1)])])},s=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-card",{attrs:{color:t.computedWidgetColor,title:t.$t("dashboard.users.title")}},[a("va-button",{staticClass:"mr-0",attrs:{slot:"actions",color:"info",small:"",flat:""},on:{click:t.updateUsers},slot:"actions"},[a("va-icon",{attrs:{name:"material-icons"}},[t._v("autorenew")])],1),a("div",{staticClass:"row align--center mb-1"},[a("div",{staticClass:"flex xs6 sm6 md6 justify--end"},[a("va-input",{staticClass:"ma-0",attrs:{value:t.term,placeholder:t.$t("tables.search"),removable:""},on:{input:t.search}},[a("va-icon",{attrs:{slot:"prepend",name:"fa fa-search"},slot:"prepend"})],1)],1),a("div",{staticClass:"flex xs10 sm10 md4"},[a("div",{staticClass:"d-flex justify--end"},[a("va-button-toggle",{staticStyle:{"max-width":"100%"},attrs:{outline:"",options:t.modeOptions},model:{value:t.mode,callback:function(e){t.mode=e},expression:"mode"}})],1)])]),a("va-data-table",{attrs:{fields:t.fields,data:t.filteredData,loading:t.loading,rowClass:"user-row"},scopedSlots:t._u([{key:"icon",fn:function(e){return[a("va-icon",{attrs:{name:"fa fa-"+t.getUserIcon(e.rowData.role),color:"secondary"}})]}},{key:"starred",fn:function(e){return[e.rowData.starred?a("va-icon",{attrs:{name:"fa fa-star",color:"warning"}}):t._e()]}},{key:"status",fn:function(e){return[a("va-badge",{attrs:{color:t.getStatusColor("online"===e.rowData.status)}},[t._v(" "+t._s(e.rowData.status)+" ")])]}},{key:"unread",fn:function(e){return[a("va-button",{attrs:{small:"",flat:"",disabled:!e.rowData.unread,color:e.rowData.unread?t.$themes.info:"#00000088"},on:{click:function(a){return t.openDialogue(e.rowData)}}},[t._v(" "+t._s(e.rowData.unread||"")+" "),a("va-icon",{staticClass:"ml-1",attrs:{name:"fa fa-envelope"}})],1)]}},{key:"profile",fn:function(e){return[a("va-button",{attrs:{small:"",outline:"",color:"info"},on:{click:function(a){return t.getUserProfile(e.rowData)}}},[t._v(" "+t._s(t.$t("dashboard.users.profile"))+" ")])]}}])})],1)},i=[],r=a("b047"),l=a.n(r),u=a("bc3a"),c=a.n(u),d=window.location.protocol+"//"+window.location.host,f=function(){return c.a.get(d+"/api/admin/users")},p=function(){return c.a.get(d+"/api/admin/me")},m=function(t){return c.a.get(d+"/api/admin/user?id="+t)},h=function(t){return c.a.get(d+"/api/admin/user/bind?email="+t)},g=function(){return c.a.get(d+"/api/admin/actions")},v={data:function(){return{users:[],loading:!1,term:null,mode:0,userRequisite:""}},mounted:function(){this.updateUsers()},computed:{computedWidgetColor:function(){return this.$themes.background},fields:function(){return[{name:"__slot:icon",width:"30px",dataClass:"text-center"},{name:"name",title:this.$t("tables.headings.name"),width:"25%"},{name:"__slot:unread",title:this.$t("tables.headings.support"),dataClass:"text-right"},{name:"email",title:this.$t("tables.headings.email"),width:"30%"},{name:"__slot:status",title:this.$t("tables.headings.status"),width:"20%",sortField:"status"},{name:"__slot:profile",dataClass:"text-right"}]},modeOptions:function(){return[{value:0,label:this.$t("dashboard.users.all")},{value:1,label:this.$t("dashboard.users.newMessages")}]},filteredData:function(){var t=this,e=this.mode?this.users.filter((function(t){return t.unread})):this.users;return!this.term||this.term.length<1?e:e.filter((function(e){return e.name.toLowerCase().startsWith(t.term.toLowerCase())||e.email.toLowerCase().startsWith(t.term.toLowerCase())||Object.entries(e).map((function(t){return"online"===t[0]?t[1]?"online":"offline":t[1].toString()})).includes(t.term)}))}},methods:{getUserProfile:function(t){var e=this;this.$root.$emit("getting-profile"),this.$root.$emit("getting-dialogue"),m(t.id).then((function(a){var o=a.data;e.$root.$emit("open-dialogue",t),e.$root.$emit("open-profile",o)})).catch((function(t){var a;e.$root.$emit("open-profile",{}),e.showToast("Cannot open his profile. Status code "+(null!==(a=t.response.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))},openDialogue:function(t){this.$root.$emit("open-dialogue",t)},bindUser:function(){var t=this;this.loading=!0,h(this.userRequisite).then((function(){t.userRequisite="",t.updateUsers(),t.showToast("The user has been successfully binded!",{icon:"fa-check",position:"bottom-right",duration:4e3,type:"success"})})).catch((function(e){var a,o;t.loading=!1,t.showToast("The user has not been binded. Status code "+(null!==(a=null===(o=e.response)||void 0===o?void 0:o.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-right",duration:4e3,type:"error"})}))},updateUsers:function(){var t=this;this.loading=!0,f().then((function(e){var a=e.data;t.loading=!1,t.users=a})).catch((function(e){var a,o;t.loading=!1,t.showToast("There was an error when trying to fetch the users list. Status code "+(null!==(a=null===(o=e.response)||void 0===o?void 0:o.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))},getUserIcon:function(t){return["user","user-secret"][+("user"!==t)]},getStatusColor:function(t){return["danger","success"][+t]},readSupport:function(t){this.user.unread=0},search:l()((function(t){this.term=t}),400),created:function(){this.$root.$on("update-users",this.updateUsers),this.$root.$on("read-support",this.readSupport)},destroy:function(){this.$root.$off("update-users",this.updateUsers),this.$root.$off("read-support",this.readSupport)}}},b=v,y=(a("243c"),a("2877")),_=Object(y["a"])(b,n,i,!1,null,null,null),w=_.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-card",{style:t.computedStyle,attrs:{color:t.computedWidgetColor,title:t.$t("dashboard.profile.title")}},[a("va-button",{staticClass:"mr-0",attrs:{slot:"actions",small:"",outline:"",color:"info"},on:{click:t.getMyProfile},slot:"actions"},[t._v(" "+t._s(t.$t("dashboard.profile.myProfile"))+" ")]),a("div",{staticClass:"profile__name"},[a("va-icon",{staticClass:"ml-2 mr-2",attrs:{name:"fa fa-user-circle"}}),a("div",{staticClass:"profile__name_first text--capitalize"},[t._v(" "+t._s(t.user.firstName||"Loading...")+" ")]),a("div",{staticClass:"profile__name_last text--bold text--capitalize"},[t._v(" "+t._s(t.user.lastName)+" ")])],1),a("va-tabs",{style:t.computedTabsStyle,attrs:{grow:""},model:{value:t.tabsState,callback:function(e){t.tabsState=e},expression:"tabsState"}},t._l(t.tabs,(function(e,o){return a("va-tab",{key:o},[t._v(" "+t._s(t.$t("dashboard.profile.tabs."+e.toLowerCase().replace("profile","")+".title"))+" ")])})),1),a(t.tabs[t.tabsState],{tag:"component",class:["","","pb-4"][this.tabsState],attrs:{loading:t.loadingTabs.includes(t.tabs[t.tabsState])}})],1)},$=[],k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-inner-loading",{attrs:{loading:t.loading}},[a("div",{staticClass:"tab",style:t.computedStyle},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex xs12 xl12"},t._l(Object.keys(t.profile),(function(e){return a("div",{key:e,staticClass:"tab__item d-flex align--center"},[a("va-icon",{staticClass:"ml-3 mr-3",attrs:{name:t.infoIcon(e)}}),a("div",{staticClass:"text--bold tab__item-name mr-5"},[t._v(" "+t._s(e)+" ")]),a("div",[t._v(" "+t._s(t.profile[e])+" ")])],1)})),0)])])])},x=[],S={name:"profile-info-tab",inject:["user"],props:{loading:Boolean},computed:{computedStyle:function(){return{color:this.$themes.brightForeground,opacity:this.loading?.2:1}},profile:function(){var t={ID:this.user.id,Role:this.user.role.toUpperCase(),Username:this.user.username,"E-mail":this.user.email,Transfers:this.user.transfers};return this.user.me||(t["Binded to"]=this.user.bindedTo||"nobody"),t}},methods:{infoIcon:function(t){return{ID:"fa fa-id-card-o",Role:"fa fa-user-o",Username:"fa fa-address-book","E-mail":"fa fa-envelope-o",Transfers:"fa fa-money","Binded to":"fa fa-link"}[t]}}},O=S,D=(a("942f"),Object(y["a"])(O,k,x,!1,null,"dd9eec74",null)),P=D.exports,T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-inner-loading",{attrs:{loading:t.loading||t.updating}},[a("div",{staticClass:"tab",style:t.computedStyle},[a("div",{staticClass:"tab__wallets pt-3 pb-2"},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex xs12"},t._l(t.wallets,(function(e,o){return a("div",{key:o,staticClass:"tab__item d-flex align--center"},[a("va-icon",{staticClass:"ml-3 mr-3",attrs:{name:"money"}}),a("div",{staticClass:"text--bold tab__item-name mr-5 text--capitalize"},[t._v(" "+t._s(e.currency)+" ")]),a("div",[t._v(" "+t._s(e.balance-e.deltaBalance)+" ")]),a("div",{staticClass:"d-flex justify--end"},[a("va-button-toggle",{attrs:{outline:"",small:"",options:t.deltaModes},model:{value:t.deltaMode[o],callback:function(e){t.$set(t.deltaMode,o,e)},expression:"deltaMode[i]"}})],1),a("va-input",{staticClass:"ma-0",attrs:{small:"",placeholder:t.$t("dashboard.profile.tabs.wallets.deltaPlaceholder")},model:{value:t.deltas[o],callback:function(e){t.$set(t.deltas,o,e)},expression:"deltas[i]"}})],1)})),0),a("div",{staticClass:"tab__item_save mt-2"},[a("va-button",{on:{click:t.saveChanges}},[t._v(t._s(t.$t("dashboard.profile.tabs.wallets.save")))])],1)])])])])},j=[];function N(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function M(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?N(Object(a),!0).forEach((function(e){E(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):N(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function E(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var L={name:"profile-wallets-tab",inject:["user"],props:["loading"],data:function(){return{updating:!1,deltaMode:[1,1,1],deltas:[0,0,0]}},computed:{computedStyle:function(){return{color:this.$themes.brightForeground,opacity:this.updating||this.loading?.2:1}},deltaModes:function(){return[{value:0,label:"-"},{value:1,label:"+"}]},wallets:function(){return this.user.wallets.map((function(t,e){return M(M({},t),{},{deltaMode:1})}))}},methods:{updateWallet:function(t){var e=this;t.wallets.forEach((function(t,a){e.deltas[a]=t.deltaBalance}))},saveChanges:function(){var t=this,e={};this.wallets.forEach((function(a,o){if(a.deltaBalance!=t.deltas[o])try{var s=+t.deltas[o];if(NaN==s)throw new Error;e[a.currency]=s}catch(n){t.showToast("The delta must be a number",{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}})),Object.keys(e).length&&(this.updating=!0,c.a.post(window.location.protocol+"//"+window.location.host+"/api/admin/update_delta",{user:this.user.id,wallets:e}).then((function(e){t.updating=!1,t.showToast("This wallet has been updated",{icon:"fa-check",position:"bottom-center",duration:4e3,type:"success"})})).catch((function(e){t.updating=!1})))}},created:function(){this.updateWallet(this.user),this.$root.$on("update-wallet",this.updateWallet)},beforeDestroy:function(){this.$root.$off("update-wallet",this.updateWallet)}},A=L,W=(a("3219"),Object(y["a"])(A,T,j,!1,null,"3b68101a",null)),B=W.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-inner-loading",{attrs:{loading:t.loading&&t.log.length}},[t.log.length?a("div",{staticClass:"tab",style:t.computedStyle},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex xs12 xl12"},t._l(t.log[t.activePage-1],(function(e){return a("div",{key:e._id,staticClass:"tab__item d-flex align--center"},[a("va-icon",{staticClass:"ml-3 mr-3",attrs:{name:t.actionIcon(e.actionName)}}),a("div",[t._v(" "+t._s(t.$t(e.messageLocalPath))+" ")])],1)})),0)]),a("div",{staticClass:"tab__pagination_wrap"},[a("va-pagination",{attrs:{pages:t.log.length,visiblePages:"5",small:""},model:{value:t.activePage,callback:function(e){t.activePage=e},expression:"activePage"}})],1)]):a("VaCardNoData",{attrs:{loading:t.loading,LT:"Log is loading...",ET:"Empty"}})],1)},F=[],U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"no-data"},[a("va-icon",{staticClass:"no-data_icon",attrs:{name:t.loading?"fa fa-refresh fa-spin":"fa fa-sticky-note"}}),t._v(" "+t._s(t.loading?t.LT:t.ET)+" ")],1)},R=[],I={name:"va-card-no-data",props:{loading:Boolean,LT:{type:String,required:!0},ET:{type:String,required:!0}}},V=I,J=(a("a4b0"),Object(y["a"])(V,U,R,!1,null,"62f20504",null)),K=J.exports,X=a("2ef0"),Z=a.n(X),z={name:"profile-log-tab",components:{VaCardNoData:K},inject:["user"],data:function(){return{activePage:1}},props:{loading:Boolean},computed:{computedStyle:function(){return{color:this.$themes.brightForeground,opacity:this.loading?.2:1}},log:function(){return Z.a.chunk(this.user.log,6)}},methods:{actionIcon:function(t){return{registered:"fa fa-user-plus",authenticated:"fa fa-sign-in",visited:"fa fa-map-marker",name_changed:"fa fa-edit"}[t]}},mounted:function(){this.activePage=this.log.length}},Y=z,H=(a("3b36"),Object(y["a"])(Y,q,F,!1,null,"5a9fb366",null)),G=H.exports,Q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-inner-loading",{attrs:{loading:t.loading&&t.actions.length}},[t.actions.length?a("div",{staticClass:"tab",style:t.computedStyle},[a("div",{staticClass:"tab__actions"},t._l(t.actions,(function(e){return a("va-button",{key:e.name,attrs:{outline:"",color:e.color},on:{click:function(a){return t.doAPIRequest(e.url)}}},[t._v(t._s(t.$t(e.nameLocalPath)))])})),1)]):a("VaCardNoData",{attrs:{loading:t.loading,LT:"Actions are loading...",ET:"Nothing to do"}})],1)},tt=[],et={components:{VaCardNoData:K},props:{loading:Boolean},inject:["user"],computed:{actions:function(){return this.user.actions},computedStyle:function(){return{opacity:this.loading?.2:1}}},methods:{doAPIRequest:function(t){var e=this;console.log(window.location.protocol+"//"+window.location.host+t),this.loading=!0,c.a.get(window.location.protocol+"//"+window.location.host+t).then((function(t){var a=t.data;e.loading=!1,e.$root.$emit("refresh-profile"),a.success?"sign in as"===a.action?(sessionStorage.setItem("auth-token",a.token),window.location.assign(window.location.protocol+"//"+window.location.host)):e.showToast("The user has been ".concat(a.action,"d!"),{icon:"fa-check",position:"bottom-center",duration:4e3,type:"success"}):(console.log(a),e.showToast("The user has not been ".concat(a.action,"d."),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"}))})).catch((function(t){var a,o=t.response;e.loading=!0,e.showToast(o.data.message+" Status code "+(null!==(a=o.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))}}},at=et,ot=(a("b9cd"),Object(y["a"])(at,Q,tt,!1,null,"27c5c344",null)),st=ot.exports,nt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab"},[a("div",{staticClass:"tab__bind pt-3 pb-2"},[a("va-input",{staticClass:"ma-0",attrs:{placeholder:t.$t("forms.bindUser.placeholder"),messages:[t.$t("forms.bindUser.description")]},model:{value:t.userRequisite,callback:function(e){t.userRequisite=e},expression:"userRequisite"}},[a("va-icon",{attrs:{slot:"prepend",color:"gray",name:"fa fa-link"},slot:"prepend"}),a("va-button",{staticStyle:{"margin-right":"0"},attrs:{slot:"append",small:""},on:{click:t.bindUser},slot:"append"},[t._v(" "+t._s(t.$t("forms.bindUser.submit"))+" ")])],1)],1)])},it=[],rt={name:"profile-bind-tab",data:function(){return{userRequisite:""}},methods:{bindUser:function(){var t=this;this.loading=!0,h(this.userRequisite).then((function(){t.userRequisite="",t.$root.$emit("update-users"),t.showToast("The user has been successfully binded!",{icon:"fa-check",position:"bottom-right",duration:4e3,type:"success"})})).catch((function(e){var a,o;t.loading=!1,t.showToast("The user has not been binded. Status code "+(null!==(a=null===(o=e.response)||void 0===o?void 0:o.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-right",duration:4e3,type:"error"})}))}}},lt=rt,ut=(a("d33d"),Object(y["a"])(lt,nt,it,!1,null,"598b86f4",null)),ct=ut.exports;function dt(t,e){return mt(t)||pt(t,e)||ft()}function ft(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function pt(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],o=!0,s=!1,n=void 0;try{for(var i,r=t[Symbol.iterator]();!(o=(i=r.next()).done);o=!0)if(a.push(i.value),e&&a.length===e)break}catch(l){s=!0,n=l}finally{try{o||null==r["return"]||r["return"]()}finally{if(s)throw n}}return a}}function mt(t){if(Array.isArray(t))return t}var ht={name:"DashboardProfile",components:{ProfileInfo:P,ProfileWallets:B,ProfileLog:G,ProfileActions:st,ProfileBind:ct},data:function(){return{user:{id:"...",role:"...",username:"...",transfers:"...",telegramUsername:"...",name:"",email:"...",bindedTo:"...",actions:[],log:[],me:!1,wallets:"empty"},loadingTabs:["ProfileInfo","ProfileWallets","ProfileLog","ProfileActions"],tabsState:0,myRole:""}},provide:function(){return{user:this.user}},computed:{computedWidgetColor:function(){return this.$themes.background},computedStyle:function(){return{color:this.$themes.brightForeground}},computedTabsStyle:function(){return{color:this.$themes.secondary}},tabs:function(){var t=["ProfileInfo"];return"user"===this.user.role&&t.push("ProfileWallets"),t.push("ProfileLog"),t.push("ProfileActions"),"manager"===this.myRole&&t.push("ProfileBind"),this.tabsState=this.tabsState>t.length-1?t.length-1:this.tabsState,t}},methods:{getMyProfile:function(){var t=this;this.loading(),this.$root.$emit("getting-dialogue"),p().then((function(e){var a=e.data;t.myRole=a.role,t.$root.$emit("open-dialogue",a),t.updateOpenedProfile(a,!0)})).catch((function(e){var a;t.loaded(),t.showToast("Cannot open your profile. Status code "+(null!==(a=e.response.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))},updateOpenedProfile:function(t,e){var a=this;this.$root.$emit("update-wallet",t),this.loaded(),this.user.me=!!e;var o=t.name.split(" "),s=dt(o,2);this.user.firstName=s[0],this.user.lastName=s[1],Object.keys(t).length&&Object.keys(t).forEach((function(e){a.user[e]=t[e]}))},refreshOpenedProfile:function(){var t=this;this.$root.$emit("getting-dialogue"),m(this.user.id).then((function(e){var a=e.data;t.$root.$emit("open-dialogue",t.user),t.$root.$emit("open-profile",a)})).catch((function(e){var a;t.getMyProfile(),t.showToast("Cannot open his profile. Status code "+(null!==(a=e.response.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))},loading:function(){this.loadingTabs=["ProfileInfo","ProfileWallets","ProfileLog","ProfileActions"]},loaded:function(){this.loadingTabs=[]},gettingProfile:function(){this.loading()}},created:function(){this.getMyProfile(),this.$root.$on("getting-profile",this.gettingProfile),this.$root.$on("open-profile",this.updateOpenedProfile),this.$root.$on("refresh-profile",this.refreshOpenedProfile)},beforeDestroy:function(){this.$root.$off("getting-profile",this.loading),this.$root.$off("open-profile",this.updateOpenedProfile),this.$root.$off("refresh-profile",this.refreshOpenedProfile)}},gt=ht,vt=(a("55e0"),Object(y["a"])(gt,C,$,!1,null,"641202ee",null)),bt=vt.exports,yt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-card",{style:t.computedWidgetStyle,attrs:{color:t.$themes.background,title:t.$t("dashboard.support.title")}},[a("h6",{staticClass:"user-title",style:{color:t.$themes.foreground},attrs:{slot:"actions"},slot:"actions"},[a("va-icon",{staticClass:"mr-2",attrs:{name:"fa fa-user-circle"}}),t._v(" "+t._s(t.user.name)+" ")],1),a("va-inner-loading",{attrs:{loading:!t.itsAdmin&&t.loading}},[t.itsAdmin?a("VaCardNoData",{attrs:{loading:t.loading,LT:"Fetching support messages...",ET:"Can't talk to this person"}}):a("div",{staticClass:"tab",style:t.computedStyle},[a("chat",{attrs:{value:t.user.supportMessages,height:"25.5rem"},on:{input:t.sendMessage}})],1)],1)],1)},_t=[],wt=a("ed06"),Ct=window.location.protocol+"//"+window.location.host,$t=function(t){return c.a.get(Ct+"/api/admin/support?user="+t)},kt=function(t,e){return c.a.post(Ct+"/api/admin/support/"+t+"/send",{message:e})},xt={name:"dashboard-support",components:{Chat:wt["a"],VaCardNoData:K},props:{loading:Boolean},data:function(){return{user:{id:"...",name:"",supportMessages:[]},loading:!1,itsAdmin:!1}},methods:{sendMessage:function(t){var e=this,a=this.user.supportMessages.length;this.user.supportMessages.push(t),kt(this.user.id,t.text).then((function(t){var o=t.data;e.user.supportMessages[a]=o.message,e.user.supportMessages=e.user.supportMessages.slice()}))},gettingDialogue:function(){this.loading=!0},openDialogue:function(t){var e=this;$t(t.id).then((function(a){var o=a.data;e.unread=0,e.loading=!1,e.itsAdmin=!1,e.user.id=t.id,e.user.name=t.name,e.user.supportMessages=o.messages,e.$root.$emit("read-support",t.id)})).catch((function(t){e.loading=!1,e.itsAdmin=!0}))}},computed:{computedStyle:function(){return{color:this.$themes.brightForeground,opacity:this.loading?.2:1}},computedWidgetStyle:function(){return{color:this.$themes.brightForeground}}},created:function(){this.$root.$on("open-dialogue",this.openDialogue),this.$root.$on("getting-dialogue",this.gettingDialogue)},beforeDestroy:function(){this.$root.$off("open-dialogue",this.openDialogue),this.$root.$off("getting-dialogue",this.gettingDialogue)}},St=xt,Ot=(a("e3b1"),Object(y["a"])(St,yt,_t,!1,null,"385d2b9b",null)),Dt=Ot.exports,Pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-card",{style:t.computedWidgetStyle,attrs:{color:t.$themes.background,title:t.$t("dashboard.totalLog.title")}},[a("va-button",{staticClass:"mr-0",attrs:{slot:"actions",color:"info",small:"",flat:""},on:{click:t.refresh},slot:"actions"},[a("va-icon",{attrs:{name:"material-icons"}},[t._v("autorenew")])],1),a("va-inner-loading",{attrs:{loading:t.log.length&&t.loading}},[t.log.length?a("div",{staticClass:"tab",style:t.computedStyle},[a("div",{staticClass:"row"},[a("div",{staticClass:"flex xs12 xl12"},t._l(t.log[t.activePage-1],(function(e){return a("div",{key:e._id,staticClass:"tab__item align--center"},[a("va-icon",{staticClass:"ml-3 mr-3",attrs:{name:t.actionIcon(e.actionName)}}),a("div",[t._v(" "+t._s(t.$t(e.messageLocalPath))+" "+t._s(e.relatedData)+" ")]),a("div",{staticClass:"ml-3 mr-3"},[t._v(" "+t._s(e.user.name)+" ")]),a("div",{staticStyle:{"text-align":"center"}},[t._v(" "+t._s(e.formatedDate)+" ")])],1)})),0)]),a("div",{staticClass:"tab__pagination_wrap"},[a("va-pagination",{attrs:{pages:t.log.length,visiblePages:"5",small:""},model:{value:t.activePage,callback:function(e){t.activePage=e},expression:"activePage"}})],1)]):a("VaCardNoData",{attrs:{loading:t.loading,LT:"Log is loading...",ET:"Empty"}})],1)],1)},Tt=[],jt={name:"dashboard-total-log",components:{VaCardNoData:K},data:function(){return{loading:!1,activePage:1,actions:[]}},computed:{computedStyle:function(){return{color:this.$themes.brightForeground,opacity:this.loading?.2:1}},computedWidgetStyle:function(){return{color:this.$themes.brightForeground}},log:function(){return Z.a.chunk(this.actions,8)}},methods:{refresh:function(){var t=this;this.loading=!0,g().then((function(e){var a=e.data;t.loading=!1,t.actions=a}))},actionIcon:function(t){return{registered:"fa fa-user-plus",authenticated:"fa fa-sign-in",visited:"fa fa-map-marker",name_changed:"fa fa-edit"}[t]}},mounted:function(){this.refresh()}},Nt=jt,Mt=(a("19ee"),Object(y["a"])(Nt,Pt,Tt,!1,null,"c8e986da",null)),Et=Mt.exports,Lt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("va-card",{attrs:{color:t.computedWidgetColor,title:t.$t("dashboard.support.dialogues")}},[a("va-button",{staticClass:"mr-0",attrs:{slot:"actions",color:"info",small:"",flat:""},on:{click:t.updateDialogues},slot:"actions"},[a("va-icon",{attrs:{name:"material-icons"}},[t._v("autorenew")])],1),a("div",{staticClass:"row align--center mb-1"},[a("div",{staticClass:"flex xs12 sm12 md12"},[a("va-input",{staticClass:"ma-0",attrs:{value:t.term,placeholder:t.$t("tables.searchByName"),removable:""},on:{input:t.search}},[a("va-icon",{attrs:{slot:"prepend",name:"fa fa-search"},slot:"prepend"})],1)],1)]),a("va-data-table",{attrs:{fields:t.fields,data:t.filteredData,loading:t.loading,rowClass:"user-row"},scopedSlots:t._u([{key:"icon",fn:function(){return[a("va-icon",{attrs:{name:"fa fa-user",color:"secondary"}})]},proxy:!0},{key:"starred",fn:function(e){return[e.rowData.starred?a("va-icon",{attrs:{name:"fa fa-star",color:"warning"}}):t._e()]}},{key:"online",fn:function(e){return[a("va-badge",{attrs:{color:t.getStatusColor(e.rowData.online)}},[t._v(" "+t._s(Boolean(e.rowData.online)?"online":"offline")+" ")])]}},{key:"messagesCount",fn:function(e){return[a("va-button",{attrs:{small:"",flat:"",color:"info"},on:{click:t.openDialogue}},[t._v(" "+t._s(e.rowData.messagesCount)+" "),a("va-icon",{staticClass:"ml-1",attrs:{name:"fa fa-envelope"}})],1)]}}])})],1)},At=[],Wt=a("b614"),Bt={data:function(){return{users:Wt.map((function(t){return t.name=t.firstName+" "+t.lastName,t})),loading:!1,term:null,mode:0,userRequisite:""}},mounted:function(){},computed:{computedWidgetColor:function(){return this.$themes.background},fields:function(){return[{name:"__slot:icon",width:"30px",dataClass:"text-center"},{name:"name",title:this.$t("tables.headings.name"),width:"30%"},{name:"email",title:this.$t("tables.headings.email"),width:"50%"},{name:"__slot:online",title:this.$t("tables.headings.status"),width:"10%"},{name:"__slot:messagesCount",dataClass:"text-right",sortField:"online"}]},filteredData:function(){var t=this;return!this.term||this.term.length<1?this.users:this.users.filter((function(e){return e.name.toLowerCase().startsWith(t.term.toLowerCase())||e.email.toLowerCase().startsWith(t.term.toLowerCase())||Object.entries(e).map((function(t){return"online"===t[0]?t[1]?"online":"offline":t[1].toString()})).includes(t.term)}))}},methods:{updateDialogues:function(){var t=this;this.loading=!0,UsersList().then((function(e){var a=e.data;t.loading=!1,t.users=a})).catch((function(e){var a,o;t.loading=!1,t.showToast("There was an error when trying to fetch the users list. Status code "+(null!==(a=null===(o=e.response)||void 0===o?void 0:o.status)&&void 0!==a?a:"%CODE%"),{icon:"fa-times",position:"bottom-center",duration:4e3,type:"error"})}))},getStatusColor:function(t){return["danger","success"][+t]},search:l()((function(t){this.term=t}),400)}},qt=Bt,Ft=(a("3e44"),Object(y["a"])(qt,Lt,At,!1,null,null,null)),Ut=Ft.exports,Rt={name:"dashboard",components:{DashboardUsers:w,DashboardProfile:bt,DashboardSupport:Dt,DashboardTotalLog:Et,DashboardDialogues:Ut},methods:{addAddressToMap:function(t){var e=t.city,a=t.country;this.$refs.dashboardMap.addAddress({city:e.text,country:a})}}},It=Rt,Vt=(a("c5cb"),Object(y["a"])(It,o,s,!1,null,null,null));e["default"]=Vt.exports},a841:function(t,e,a){},ab28:function(t,e,a){"use strict";var o=a("bec2"),s=a.n(o);s.a},b047:function(t,e,a){var o=a("1a8c"),s=a("408c"),n=a("b4b0"),i="Expected a function",r=Math.max,l=Math.min;function u(t,e,a){var u,c,d,f,p,m,h=0,g=!1,v=!1,b=!0;if("function"!=typeof t)throw new TypeError(i);function y(e){var a=u,o=c;return u=c=void 0,h=e,f=t.apply(o,a),f}function _(t){return h=t,p=setTimeout($,e),g?y(t):f}function w(t){var a=t-m,o=t-h,s=e-a;return v?l(s,d-o):s}function C(t){var a=t-m,o=t-h;return void 0===m||a>=e||a<0||v&&o>=d}function $(){var t=s();if(C(t))return k(t);p=setTimeout($,w(t))}function k(t){return p=void 0,b&&u?y(t):(u=c=void 0,f)}function x(){void 0!==p&&clearTimeout(p),h=0,u=m=c=p=void 0}function S(){return void 0===p?f:k(s())}function O(){var t=s(),a=C(t);if(u=arguments,c=this,m=t,a){if(void 0===p)return _(m);if(v)return clearTimeout(p),p=setTimeout($,e),y(m)}return void 0===p&&(p=setTimeout($,e)),f}return e=n(e)||0,o(a)&&(g=!!a.leading,v="maxWait"in a,d=v?r(n(a.maxWait)||0,e):d,b="trailing"in a?!!a.trailing:b),O.cancel=x,O.flush=S,O}t.exports=u},b0a8:function(t,e,a){},b4b0:function(t,e,a){var o=a("1a8c"),s=a("ffd69"),n=NaN,i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;function d(t){if("number"==typeof t)return t;if(s(t))return n;if(o(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var a=l.test(t);return a||u.test(t)?c(t.slice(2),a?2:8):r.test(t)?n:+t}t.exports=d},b614:function(t){t.exports=JSON.parse('[{"id":"mFtyLfBWXSeVL4pqk_Dh3","role":"user","firstName":"John","lastName":"Doe","email":"sobaka@kerua.ka","status":"offline","support":{"newMessagesCount":1}},{"id":"l2tFRO-513l0sKABZ4rdC","role":"admin","firstName":"Andrey","lastName":"Nevinny","email":"psoglav.ih8u@gmail.com","status":"online","support":{"newMessagesCount":12}},{"id":"mFtyLfBWXSeVL4pqk_Dh3","role":"user","firstName":"John","lastName":"Doe","email":"sobaka@kerua.ka","status":"offline","support":{"newMessagesCount":0}},{"id":"l2tFRO-513l0sKABZ4rdC","role":"admin","firstName":"Andrey","lastName":"Nevinny","email":"psoglav.ih8u@gmail.com","status":"online","support":{"newMessagesCount":16}},{"id":"mFtyLfBWXSeVL4pqk_Dh3","role":"user","firstName":"John","lastName":"Doe","email":"sobaka@kerua.ka","status":"offline","support":{"newMessagesCount":2}},{"id":"l2tFRO-513l0sKABZ4rdC","role":"admin","firstName":"Andrey","lastName":"Nevinny","email":"psoglav.ih8u@gmail.com","status":"online","support":{"newMessagesCount":1}},{"id":"mFtyLfBWXSeVL4pqk_Dh3","role":"user","firstName":"John","lastName":"Doe","email":"sobaka@kerua.ka","status":"offline","support":{"newMessagesCount":0}},{"id":"l2tFRO-513l0sKABZ4rdC","role":"admin","firstName":"Andrey","lastName":"Nevinny","email":"psoglav.ih8u@gmail.com","status":"online","support":{"newMessagesCount":0}},{"id":"mFtyLfBWXSeVL4pqk_Dh3","role":"user","firstName":"John","lastName":"Doe","email":"sobaka@kerua.ka","status":"offline","support":{"newMessagesCount":1}},{"id":"l2tFRO-513l0sKABZ4rdC","role":"admin","firstName":"Andrey","lastName":"Nevinny","email":"psoglav.ih8u@gmail.com","status":"online","support":{"newMessagesCount":1}}]')},b9cd:function(t,e,a){"use strict";var o=a("b0a8"),s=a.n(o);s.a},bec2:function(t,e,a){},bee1:function(t,e,a){},c5cb:function(t,e,a){"use strict";var o=a("fdad"),s=a.n(o);s.a},d33d:function(t,e,a){"use strict";var o=a("8ef1"),s=a.n(o);s.a},db6b:function(t,e,a){},e3b1:function(t,e,a){"use strict";var o=a("7b09"),s=a.n(o);s.a},e709:function(t,e,a){},ed06:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"va-chat"},[a("div",{directives:[{name:"sticky-scroll",rawName:"v-sticky-scroll",value:{animate:!0,duration:200},expression:"{\n      animate: true,\n      duration: 200,\n    }"}],staticClass:"va-chat__body",style:{height:t.height,backgroundColor:"#00000017"}},t._l(t.value,(function(e,o){return a("div",{key:o,staticClass:"va-chat__message",class:{"va-chat__message--yours":e.yours},style:Object.assign({},e.yours?t.computedYoursStyle:t.computedStyle,{paddingTop:e.delivered?"0.657rem":"1.4rem"})},[a("div",{staticClass:"va-chat__message-info",style:{left:e.yours?"auto":"0.5rem",right:e.yours?"0.5rem":"auto"}},[e.delivered?t._e():a("va-icon",{attrs:{name:"fa fa-spinner fa-spin"}})],1),a("span",{staticClass:"va-chat__message-text",style:{textAlign:e.yours?"right":"left"}},[t._v(" "+t._s(e.text)+" ")]),a("span",{staticClass:"va-chat__message_date",style:{opacity:.4,textAlign:e.yours?"right":"left"}},[t._v(" "+t._s(e.date)+" ")])])})),0),a("div",{staticClass:"va-chat__controls"},[a("va-input",{staticClass:"va-chat__input",attrs:{autosize:!0,placeholder:t.$t("dashboard.support.placeholder")},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage(e)}},model:{value:t.inputMessage,callback:function(e){t.inputMessage=e},expression:"inputMessage"}}),a("va-button",{on:{click:t.sendMessage}},[t._v(" "+t._s(t.$t("buttons.send"))+" ")])],1)])},s=[],n=a("8800"),i={name:"chat",directives:{StickyScroll:n["a"]},data:function(){return{inputMessage:""}},computed:{computedStyle:function(){return{backgroundColor:this.$themes.darkForeground,color:"white"}},computedYoursStyle:function(){return{backgroundColor:this.$themes.info,color:"white"}}},props:{value:Array,height:{default:"20rem",type:String}},watch:{value:function(){var t=this.$el.querySelector(".va-chat__body");t.scrollTop=t.scrollHeight}},methods:{sendMessage:function(){var t=this;this.inputMessage&&(this.$emit("input",{text:this.inputMessage,yours:!0}),this.inputMessage="",setTimeout((function(){t.$el.querySelector(".va-chat__input").focus()}),10))}}},r=i,l=(a("ab28"),a("2877")),u=Object(l["a"])(r,o,s,!1,null,null,null);e["a"]=u.exports},fdad:function(t,e,a){},ffd69:function(t,e,a){var o=a("3729"),s=a("1310"),n="[object Symbol]";function i(t){return"symbol"==typeof t||s(t)&&o(t)==n}t.exports=i}}]);
//# sourceMappingURL=chunk-ff3ee716.79d9f83f.js.map