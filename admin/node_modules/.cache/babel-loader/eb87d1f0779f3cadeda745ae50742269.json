{"remainingRequest":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/babel-loader/lib/index.js!/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/cache-loader/dist/cjs.js??ref--0-0!/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/vue-loader/lib/index.js??vue-loader-options!/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/src/components/dashboard/DashboardSupport.vue?vue&type=script&lang=js&","dependencies":[{"path":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/src/components/dashboard/DashboardSupport.vue","mtime":1603529868026},{"path":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/mnt/d/Working_Area/DEV/CUSTOMERS/clean-vuestic/2/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBDaGF0IGZyb20gJy4uL3VpL2NoYXQvQ2hhdCc7CmltcG9ydCBWYUNhcmROb0RhdGEgZnJvbSAnLi9jb21wb25lbnRzL1ZhQ2FyZE5vRGF0YSc7CmltcG9ydCAqIGFzIFN1cHBvcnQgZnJvbSAnLi4vLi4vc2VydmljZXMvU3VwcG9ydCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnZGFzaGJvYXJkLXN1cHBvcnQnLAogIGNvbXBvbmVudHM6IHsKICAgIENoYXQ6IENoYXQsCiAgICBWYUNhcmROb0RhdGE6IFZhQ2FyZE5vRGF0YQogIH0sCiAgcHJvcHM6IHsKICAgIGxvYWRpbmc6IEJvb2xlYW4KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyOiB7CiAgICAgICAgaWQ6ICcnLAogICAgICAgIG5hbWU6ICcnLAogICAgICAgIHN1cHBvcnRNZXNzYWdlczogW10KICAgICAgfSwKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGl0c0FkbWluOiB0cnVlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc3RhcnRGZXRjaGluZ01lc3NhZ2VzOiBmdW5jdGlvbiBzdGFydEZldGNoaW5nTWVzc2FnZXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBTdXBwb3J0LmZldGNoTWVzc2FnZXModGhpcy51c2VyLmlkKS50aGVuKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgdmFyIGRhdGEgPSBfcmVmLmRhdGE7CiAgICAgICAgX3RoaXMudXNlci5zdXBwb3J0TWVzc2FnZXMgPSBkYXRhLm1lc3NhZ2VzOwogICAgICAgIHNldFRpbWVvdXQoX3RoaXMuc3RhcnRGZXRjaGluZ01lc3NhZ2VzLCAyMDAwKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0pOwogICAgfSwKICAgIHNlbmRNZXNzYWdlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtZXNzYWdlKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGkgPSB0aGlzLnVzZXIuc3VwcG9ydE1lc3NhZ2VzLmxlbmd0aDsKICAgICAgdGhpcy51c2VyLnN1cHBvcnRNZXNzYWdlcy5wdXNoKG1lc3NhZ2UpOwogICAgICBTdXBwb3J0LnNlbmRNZXNzYWdlKHRoaXMudXNlci5pZCwgbWVzc2FnZS50ZXh0KS50aGVuKGZ1bmN0aW9uIChfcmVmMikgewogICAgICAgIHZhciBkYXRhID0gX3JlZjIuZGF0YTsKICAgICAgICBfdGhpczIudXNlci5zdXBwb3J0TWVzc2FnZXNbaV0gPSBkYXRhLm1lc3NhZ2U7CiAgICAgICAgX3RoaXMyLnVzZXIuc3VwcG9ydE1lc3NhZ2VzID0gX3RoaXMyLnVzZXIuc3VwcG9ydE1lc3NhZ2VzLnNsaWNlKCk7CiAgICAgIH0pOwogICAgfSwKICAgIGdldHRpbmdEaWFsb2d1ZTogZnVuY3Rpb24gZ2V0dGluZ0RpYWxvZ3VlKCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwogICAgfSwKICAgIG9wZW5EaWFsb2d1ZTogZnVuY3Rpb24gb3BlbkRpYWxvZ3VlKF9yZWYzKSB7CiAgICAgIHZhciB1c2VyID0gX3JlZjMudXNlciwKICAgICAgICAgIG1lc3NhZ2VzID0gX3JlZjMubWVzc2FnZXM7CiAgICAgIHRoaXMudW5yZWFkID0gMDsKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaXRzQWRtaW4gPSB1c2VyLnJvbGUgIT0gJ3VzZXInOwogICAgICB0aGlzLnVzZXIuaWQgPSB1c2VyLmlkOwogICAgICB0aGlzLnVzZXIubmFtZSA9IHVzZXIubmFtZTsKCiAgICAgIGlmICghdGhpcy5pdHNBZG1pbikgewogICAgICAgIHRoaXMudXNlci5zdXBwb3J0TWVzc2FnZXMgPSBtZXNzYWdlczsKICAgICAgICBzZXRUaW1lb3V0KHRoaXMuc3RhcnRGZXRjaGluZ01lc3NhZ2VzLCAyMDAwKTsKICAgICAgfQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNvbXB1dGVkU3R5bGU6IGZ1bmN0aW9uIGNvbXB1dGVkU3R5bGUoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgY29sb3I6IHRoaXMuJHRoZW1lcy5icmlnaHRGb3JlZ3JvdW5kLAogICAgICAgIG9wYWNpdHk6IHRoaXMubG9hZGluZyA/IDAuMiA6IDEKICAgICAgfTsKICAgIH0sCiAgICBjb21wdXRlZFdpZGdldFN0eWxlOiBmdW5jdGlvbiBjb21wdXRlZFdpZGdldFN0eWxlKCkgewogICAgICByZXR1cm4gewogICAgICAgIGNvbG9yOiB0aGlzLiR0aGVtZXMuYnJpZ2h0Rm9yZWdyb3VuZAogICAgICB9OwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIHRoaXMuJHJvb3QuJG9uKCdvcGVuLWRpYWxvZ3VlJywgdGhpcy5vcGVuRGlhbG9ndWUpOwogICAgdGhpcy4kcm9vdC4kb24oJ2dldHRpbmctZGlhbG9ndWUnLCB0aGlzLmdldHRpbmdEaWFsb2d1ZSk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy4kcm9vdC4kb2ZmKCdvcGVuLWRpYWxvZ3VlJywgdGhpcy5vcGVuRGlhbG9ndWUpOwogICAgdGhpcy4kcm9vdC4kb2ZmKCdnZXR0aW5nLWRpYWxvZ3VlJywgdGhpcy5nZXR0aW5nRGlhbG9ndWUpOwogIH0KfTs="},{"version":3,"sources":["DashboardSupport.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <va-card\r\n    :color=\"$themes.background\"\r\n    :style=\"computedWidgetStyle\"\r\n    :title=\"$t('dashboard.support.title')\"\r\n  >\r\n    <h6\r\n      slot=\"actions\"\r\n      class=\"user-title\"\r\n      :style=\"{ color: $themes.foreground }\"\r\n    >\r\n      <va-icon name=\"fa fa-user-circle\" class=\"mr-2\"></va-icon>\r\n      {{ user.name }}\r\n    </h6>\r\n    <va-inner-loading :loading=\"!itsAdmin && loading\">\r\n      <div v-if=\"!itsAdmin\" class=\"tab\" :style=\"computedStyle\">\r\n        <chat :value=\"user.supportMessages\" @input=\"sendMessage\" />\r\n      </div>\r\n      <VaCardNoData\r\n        v-else\r\n        :loading=\"loading\"\r\n        LT=\"Fetching support messages...\"\r\n        ET=\"Can't talk to this person\"\r\n      />\r\n    </va-inner-loading>\r\n  </va-card>\r\n</template>\r\n\r\n<script>\r\nimport Chat from '../ui/chat/Chat'\r\nimport VaCardNoData from './components/VaCardNoData'\r\nimport * as Support from '../../services/Support'\r\n\r\nexport default {\r\n  name: 'dashboard-support',\r\n  components: { Chat, VaCardNoData },\r\n  props: {\r\n    loading: Boolean,\r\n  },\r\n  data: () => ({\r\n    user: {\r\n      id: '',\r\n      name: '',\r\n      supportMessages: [],\r\n    },\r\n    loading: false,\r\n    itsAdmin: true,\r\n  }),\r\n  methods: {\r\n    startFetchingMessages() {\r\n      Support.fetchMessages(this.user.id)\r\n        .then(({ data }) => {\r\n          this.user.supportMessages = data.messages\r\n          setTimeout(this.startFetchingMessages, 2000)\r\n        })\r\n        .catch(err => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    sendMessage(message) {\r\n      let i = this.user.supportMessages.length\r\n\r\n      this.user.supportMessages.push(message)\r\n\r\n      Support.sendMessage(this.user.id, message.text).then(({ data }) => {\r\n        this.user.supportMessages[i] = data.message\r\n        this.user.supportMessages = this.user.supportMessages.slice()\r\n      })\r\n    },\r\n    gettingDialogue() {\r\n      this.loading = true\r\n    },\r\n    openDialogue({ user, messages }) {\r\n      this.unread = 0\r\n      this.loading = false\r\n      this.itsAdmin = user.role != 'user'\r\n      this.user.id = user.id\r\n      this.user.name = user.name\r\n\r\n      if (!this.itsAdmin) {\r\n        this.user.supportMessages = messages\r\n        setTimeout(this.startFetchingMessages, 2000)\r\n      }\r\n    },\r\n  },\r\n  computed: {\r\n    computedStyle() {\r\n      return {\r\n        color: this.$themes.brightForeground,\r\n        opacity: this.loading ? 0.2 : 1,\r\n      }\r\n    },\r\n    computedWidgetStyle() {\r\n      return {\r\n        color: this.$themes.brightForeground,\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.$root.$on('open-dialogue', this.openDialogue)\r\n    this.$root.$on('getting-dialogue', this.gettingDialogue)\r\n  },\r\n  beforeDestroy() {\r\n    this.$root.$off('open-dialogue', this.openDialogue)\r\n    this.$root.$off('getting-dialogue', this.gettingDialogue)\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.tab {\r\n  height: 100%;\r\n}\r\n\r\n.no-data {\r\n  min-height: 65px;\r\n  padding-top: 0.5rem;\r\n  font-size: 1.2rem;\r\n  text-align: center;\r\n}\r\n\r\n.user-title {\r\n  font-size: 0.8rem;\r\n  letter-spacing: 0.06rem;\r\n  font-weight: 500;\r\n  text-transform: uppercase;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/dashboard"}]}